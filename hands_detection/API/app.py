import cv2
import numpy as np
from flask import Flask
from flask_sock import Sock
import mediapipe as mp

app = Flask(__name__)
sock = Sock(app)

mp_hands = mp.solutions.hands
mp_drawing = mp.solutions.drawing_utils
hands = mp_hands.Hands(static_image_mode=False, max_num_hands=2, min_detection_confidence=0.5)

puntos_correctos_a = [
    [0.3899029493331909, 0.5983290076255798, -1.20123183933174e-06],
    [0.5690808296203613, 0.535675048828125, -0.041732121258974075],
    [0.7105618715286255, 0.42577654123306274, -0.0587068572640419],
    [0.8097320795059204, 0.32227039337158203, -0.08518218994140625],
    [0.8850561380386353, 0.24474023282527924, -0.1061994880437851],
    [0.6070766448974609, 0.2799985110759735, 0.0074511184357106686],
    [0.6363704800605774, 0.1799328476190567, -0.07862775772809982],
    [0.6124398708343506, 0.2813684344291687, -0.13215120136737823],
    [0.5889914035797119, 0.3712860643863678, -0.14996717870235443],
    [0.4950551688671112, 0.27106937766075134, -0.003384589683264494],
    [0.5206844210624695, 0.174390971660614, -0.1001226082444191],
    [0.5080667734146118, 0.3120410442352295, -0.13056999444961548],
    [0.4963538944721222, 0.4140177369117737, -0.12443476170301437],
    [0.38234496116638184, 0.2798488736152649, -0.028698114678263664],
    [0.4019307494163513, 0.198895663022995, -0.1230044960975647],
    [0.4116726517677307, 0.33952853083610535, -0.11029388010501862],
    [0.41423308849334717, 0.4368825852870941, -0.07110188156366348],
    [0.26619184017181396, 0.30212387442588806, -0.058157965540885925],
    [0.289226770401001, 0.22362665832042694, -0.11443466693162918],
    [0.31954407691955566, 0.3138759732246399, -0.09318237751722336],
    [0.3327474594116211, 0.3863895535469055, -0.05817060545086861]
]

puntos_correctos_b = [
    (0.4737216532230377, 0.7189333438873291, 6.90875992859219e-07),
    (0.5954307913780212, 0.6289174556732178, -0.04804322496056557),
    (0.6297359466552734, 0.5104575753211975, -0.05840373411774635),
    (0.5362231731414795, 0.4237061142921448, -0.06685004383325577),
    (0.44197750091552734, 0.38224682211875916, -0.0754396915435791),
    (0.6154313683509827, 0.4062630832195282, 0.0011392063461244106),
    (0.6184628009796143, 0.28105002641677856, -0.028587399050593376),
    (0.6097744703292847, 0.20188458263874054, -0.06104413792490959),
    (0.6003618836402893, 0.1312555968761444, -0.08660709857940674),
    (0.5318940281867981, 0.39280617237091064, -0.003886784426867962),
    ( 0.5365020036697388, 0.2518523633480072, -0.03130878508090973),
    ( 0.5363906621932983, 0.15794020891189575, -0.06676267832517624),
    ( 0.5381316542625427, 0.07893595099449158, -0.0927945002913475),
    ( 0.45674648880958557, 0.4055764675140381, -0.01892658695578575),
    ( 0.45775991678237915, 0.27145060896873474, -0.05281488969922066),
    ( 0.4645824730396271, 0.18200251460075378, -0.08650927990674973),
    ( 0.4687820076942444, 0.110536128282547, 0.10771483182907104),
    ( 0.3773486018180847, 0.43878111243247986, -0.03903563320636749),
    ( 0.37309157848358154, 0.3338767886161804, -0.06967679411172867),
    ( 0.3797380328178406, 0.2622144818305969, -0.08655083924531937),
    ( 0.3878788948059082, 0.1989011913537979, -0.097742959856987)
]

puntos_correctos_c = [
    [0.49561452865600586, 0.7966222167015076, 7.229415928122762e-07],
    [0.6492520570755005, 0.7230750918388367, 0.0008869275916367769],
    [0.7564579248428345, 0.6064603328704834, -0.015470944344997406],
    [0.8406206965446472, 0.5237719416618347, -0.049329835921525955],
    [0.8089673519134521, 0.4436749219894409, -0.08205438405275345],
    [0.5687514543533325, 0.38065940141677856, 0.03046245686709881],
    [0.5969046950340271, 0.2090139091014862, -0.031198278069496155],
    [0.7009880542755127, 0.1830138862133026, -0.08582054078578949],
    [0.7884359359741211, 0.21234624087810516, -0.11476980149745941],
    [0.5114203095436096, 0.38155049085617065, -0.012271441519260406],
    [0.5247972011566162, 0.16832847893238068, -0.07390163838863373],
    [0.6567054390907288, 0.14114879071712494, -0.12972164154052734],
    [0.7569769024848938, 0.18760991096496582, -0.15829619765281677],
    [0.45730239152908325, 0.40455782413482666, -0.06279259920120239],
    [0.4749256372451782, 0.20843365788459778, -0.11606381088495255],
    [0.6123077869415283, 0.17374075949192047, -0.15592017769813538],
    [0.7163673639297485, 0.2001180648803711, -0.17383672297000885],
    [0.4187946319580078, 0.45309287309646606, -0.11511864513158798],
    [0.46486860513687134, 0.3094744384288788, -0.16275525093078613],
    [0.5668074488639832, 0.25537073612213135, -0.19016119837760925],
    [0.6573028564453125, 0.24700500071048737, -0.2028348594903946]
]
puntos_correctos_d = [
    [0.4966902434825897, 0.8028000593185425, 4.7099496214286773e-07],
    [0.6127942800521851, 0.7212146520614624, -0.058391038328409195],
    [0.6672296524047852, 0.6231139898300171, -0.09661351144313812],
    [0.6163989305496216, 0.5627362132072449, -0.13686881959438324],
    [0.5335338711738586, 0.5350152254104614, -0.1773824691772461],
    [0.5747684240341187, 0.42325541377067566, -0.061726078391075134],
    [0.6056476831436157, 0.26595115661621094, -0.11793013662099838],
    [0.6209882497787476, 0.1704293191432953, -0.15866945683956146],
    [0.6244902014732361, 0.08749324083328247, -0.19015632569789886],
    [0.4729630947113037, 0.44635772705078125, -0.07582690566778183],
    [0.42044520378112793, 0.3233761489391327, -0.1683511734008789],
    [0.4705456495285034, 0.3897329866886139, -0.2076328545808792],
    [0.5160489082336426, 0.46209144592285156, -0.2158377468585968],
    [0.3904052674770355, 0.5002672076225281, -0.09470967203378677],
    [0.34730595350265503, 0.3989821970462799, -0.18336759507656097],
    [0.4254385232925415, 0.46646344661712646, -0.18867254257202148],
    [0.48419424891471863, 0.5348895192146301, -0.17093682289123535],
    [0.32811036705970764, 0.5779639482498169, -0.11887429654598236],
    [0.32218772172927856, 0.5189558267593384, -0.18584436178207397],
    [0.39074382185935974, 0.5440278053283691, -0.18999344110488892],
    [0.4472195506095886, 0.576278567314148, -0.1778186708688736]
]

puntos_correctos_e = [
    [0.45902442932128906, 0.6317034363746643, -3.9747405367052124e-07],
    [0.5993601679801941, 0.5820711851119995, -0.04121795669198036],
    [0.6978483200073242, 0.4860175848007202, -0.06480592489242554],
    [0.7195711135864258, 0.3994077146053314, -0.0953790470957756],
    [0.6345400214195251, 0.39388054609298706, -0.12392137199640274],
    [0.5807654857635498, 0.30324721336364746, -0.018969256430864334],
    [0.5597947239875793, 0.16207046806812286, -0.07923435419797897],
    [0.5835905075073242, 0.19056937098503113, -0.12422635406255722],
    [0.595169723033905, 0.26188966631889343, -0.1439373791217804],
    [0.4877498745918274, 0.30556225776672363, -0.02880040556192398],
    [0.4688170850276947, 0.15409307181835175, -0.08450905233621597],
    [0.49707406759262085, 0.22647415101528168, -0.11485312134027481],
    [0.5107214450836182, 0.30751773715019226, -0.12321676313877106],
    [0.40015357732772827, 0.3221248388290405, -0.04784553125500679],
    [0.3730244040489197, 0.17156833410263062, -0.09099330753087997],
    [0.4036142826080322, 0.22460192441940308, -0.10256142169237137],
    [0.4197891652584076, 0.30403804779052734, -0.09916874766349792],
    [0.3114502727985382, 0.35208413004875183, -0.07266324013471603],
    [0.2723609507083893, 0.2343151569366455, -0.10092120617628098],
    [0.3010370135307312, 0.24349963665008545, -0.10526291280984879],
    [0.3300706744194031, 0.2902519106864929, -0.10187605768442154]
]

puntos_correctos_f = [
    [0.5528096556663513, 0.8295719623565674, 3.234757173231628e-07],
    [0.6390912532806396, 0.7220292091369629, -0.023779714480042458],
    [0.6568520069122314, 0.588860273361206, -0.03291291743516922],
    [0.6731438636779785, 0.4887227714061737, -0.05122816562652588],
    [0.6604280471801758, 0.39888429641723633, -0.06356645375490189],
    [0.5652574300765991, 0.4964892566204071, 0.03355925902724266],
    [0.5851234197616577, 0.4059363901615143, -0.052179597318172455],
    [0.6355555057525635, 0.45926693081855774, -0.12443582713603973],
    [0.6684886813163757, 0.5248334407806396, -0.15485097467899323],
    [0.5044215321540833, 0.49179476499557495, 0.011001014150679111],
    [0.4987739026546478, 0.34466877579689026, -0.029740674421191216],
    [0.49936720728874207, 0.25144073367118835, -0.0695400983095169],
    [0.4963569939136505, 0.17052200436592102, -0.09453082084655762],
    [0.4467134177684784, 0.5164309740066528, -0.028953764587640762],
    [0.43516072630882263, 0.3728519082069397, -0.07109826803207397],
    [0.43144845962524414, 0.27662742137908936, -0.09881024062633514],
    [0.42796510457992554, 0.19285032153129578, -0.11206086724996567],
    [0.39487597346305847, 0.5655971169471741, -0.07393032312393188],
    [0.3881717026233673, 0.4535275101661682, -0.09801336377859116],
    [0.383543461561203, 0.37591972947120667, -0.09854942560195923],
    [0.37937718629837036, 0.3056890666484833, -0.09620296955108643]
]

puntos_correctos_g = [
    (0.1499578356742859, 0.6198013424873352, -1.6216425535731105e-07),
    (0.17613589763641357, 0.43833181262016296, -0.008004576899111271),
    (0.2570781409740448, 0.32484087347984314, -0.0504334382712841),
    (0.30779772996902466, 0.20919263362884521, -0.09711851179599762),
    (0.3139668107032776, 0.11797559261322021, -0.15168972313404083),
    (0.5148491859436035, 0.43478336930274963, -0.07861003279685974),
    (0.7149568200111389, 0.4182559549808502, -0.1085120365023613),
    (0.8416110277175903, 0.4139935374259949, -0.13085253536701202),
    (0.9375828504562378, 0.41432759165763855, -0.14777396619319916),
    (0.5481654405593872, 0.5398985147476196, -0.08252143859863281),
    (0.6056079864501953, 0.5238259434700012, -0.08995019644498825),
    (0.5379288792610168, 0.5164309144020081, -0.06713094562292099),
    (0.4667598605155945, 0.5200623869895935, -0.056517478078603745),
    (0.5261738896369934, 0.6371786594390869, -0.08188432455062866),
    (0.5623214840888977, 0.6094244122505188, -0.07633541524410248),
    (0.4983066916465759, 0.6077373623847961, -0.03887565806508064),
    (0.42780402302742004, 0.6126453280448914, -0.021520067006349564),
    (0.4890967309474945, 0.7175819873809814, -0.08192101866006851),
    (0.5182593464851379, 0.6998245716094971, -0.06525479257106781),
    (0.46047893166542053, 0.6913840770721436, -0.024474676698446274),
    (0.4040120840072632, 0.6924404501914978, 0.003510069102048874)
]

puntos_correctos_h = [
    [0.13811445236206055, 0.6171954870223999, 1.5505499959544977e-06],
    [0.15919718146324158, 0.45574989914894104, -0.035056520253419876],
    [0.22984492778778076, 0.3500950336456299, -0.08381102979183197],
    [0.29350292682647705, 0.2518439292907715, -0.13126926124095917],
    [0.3140758275985718, 0.16407406330108643, -0.17916308343410492],
    [0.4587407410144806, 0.44899097084999084, -0.10226687788963318],
    [0.6414973735809326, 0.4515669047832489, -0.15021629631519318],
    [0.75243079662323, 0.44884008169174194, -0.1811932623386383],
    [0.8391515016555786, 0.4547739028930664, -0.19656230509281158],
    [0.48917627334594727, 0.5373309850692749, -0.10462754964828491],
    [0.6833949089050293, 0.522988498210907, -0.13833318650722504],
    [0.8117954134941101, 0.5098970532417297, -0.15358756482601166],
    [0.9024181365966797, 0.512440025806427, -0.16243387758731842],
    [0.4783864915370941, 0.6261091232299805, -0.1021224781870842],
    [0.539794385433197, 0.6243179440498352, -0.11423882842063904],
    [0.4874458611011505, 0.6118621826171875, -0.09276391565799713],
    [0.42520570755004883, 0.6102041602134705, -0.07303208857774734],
    [0.44662103056907654, 0.7005118131637573, -0.10369762033224106],
    [0.47870659828186035, 0.693882405757904, -0.10062650591135025],
    [0.4365466237068176, 0.6795704364776611, -0.06506548076868057],
    [0.39050519466400146, 0.67844557762146, -0.03280984237790108]
]

puntos_correctos_i = [
    [0.49815696477890015, 0.6027294397354126, -1.0856564358618925e-06],
    [0.6196189522743225, 0.5121504664421082, 0.01650906912982464],
    [0.6756286025047302, 0.40165162086486816, 0.01824207603931427],
    [0.7143316268920898, 0.31917065382003784, -0.003172793425619602],
    [0.6665794849395752, 0.3017400801181793, -0.023836418986320496],
    [0.5389090180397034, 0.279308557510376, 0.06769432872533798],
    [0.5767641663551331, 0.18345773220062256, 0.023572251200675964],
    [0.6396417617797852, 0.20726366341114044, -0.005574468988925219],
    [0.6729751825332642, 0.2514638602733612, -0.009749889373779297],
    [0.49892720580101013, 0.2877723276615143, 0.029703214764595032],
    [0.5750947594642639, 0.20624715089797974, -0.04213753342628479],
    [0.6201644539833069, 0.3033398985862732, -0.07698759436607361],
    [0.6191425919532776, 0.3800950348377228, -0.07509756088256836],
    [0.45758694410324097, 0.2952466607093811, -0.015578251332044601],
    [0.5438782572746277, 0.21843931078910828, -0.08781063556671143],
    [0.5868053436279297, 0.3156394362449646, -0.099199578166008],
    [0.5838006734848022, 0.3906891644001007, -0.0764913335442543],
    [0.41261765360832214, 0.30764850974082947, -0.0602465383708477],
    [0.41105303168296814, 0.18458259105682373, -0.08342420309782028],
    [0.42257875204086304, 0.1102459579706192, -0.07907798886299133],    
    [0.4348650574684143, 0.04292088747024536, -0.06590861827135086]
]

puntos_correctos_j = [
    [0.5386951565742493, 0.592934250831604, -6.219378860805591e-07],
    [0.6296635866165161, 0.5310813188552856, -0.01567607745528221],
    [0.6998719573020935, 0.4256753921508789, -0.02637692168354988],
    [0.7368585467338562, 0.33984875679016113, -0.047182612121105194],
    [0.6696430444717407, 0.3159617781639099, -0.06419210880994797],
    [0.568618655204773, 0.29618221521377563, 0.02206800878047943],
    [0.60386723279953, 0.21023251116275787, -0.026431206613779068],
    [0.6537307500839233, 0.2567261755466461, -0.05410473421216011],
    [0.6762222647666931, 0.30473658442497253, -0.05724537372589111],
    [0.521366536617279, 0.30011606216430664, 0.004075851757079363],
    [0.5862782001495361, 0.22927838563919067, -0.06571032106876373],
    [0.6187976598739624, 0.3403138816356659, -0.09030935168266296],
    [0.6107097268104553, 0.4156736731529236, -0.08159026503562927],
    [0.47066810727119446, 0.3096126317977905, -0.02287735790014267],
    [0.5398569703102112, 0.2427656650543213, -0.09152601659297943],
    [0.5810577273368835, 0.34146177768707275, -0.09746886789798737],
    [0.5791054964065552, 0.4142192602157593, -0.07283616065979004],
    [0.4153828024864197, 0.3272380232810974, -0.05087435618042946],
    [0.40901899337768555, 0.21002408862113953, -0.07800207287073135],
    [0.42204245924949646, 0.1354297697544098, -0.07970104366540909],
    [0.4302724003791809, 0.06631264090538025, -0.07064402848482132]
]

puntos_correctos_k = [
    [0.4745189845561981, 0.7268381118774414, 1.3169411658964236e-06],
    [0.5793505907058716, 0.6161192655563354, -0.029704181477427483],
    [0.5969657897949219, 0.5018303394317627, -0.0541110597550869],
    [0.5780872702598572, 0.4206249415874481, -0.08718189597129822],
    [0.5599405765533447, 0.3398839235305786, -0.11447671800851822],
    [0.4680173099040985, 0.3817186653614044, -0.03800339251756668],
    [0.480671763420105, 0.25046998262405396, -0.10309986025094986],
    [0.48810553550720215, 0.1643550544977188, -0.1400129348039627],
    [0.4947112798690796, 0.0878782868385315, -0.16063492000102997],
    [0.39695775508880615, 0.3974100351333618, -0.06204437464475632],
    [0.5057015419006348, 0.3168673813343048, -0.14658036828041077],
    [0.5947114825248718, 0.26610076427459717, -0.17566514015197754],
    [0.6664275527000427, 0.22622036933898926, -0.18113693594932556],
    [0.3486011326313019, 0.4369271993637085, -0.09293855726718903],
    [0.5299792885780334, 0.4333096444606781, -0.188191220164299],
    [0.568069577217102, 0.5256685614585876, -0.17995209991931915],
    [0.5731578469276428, 0.5877013206481934, -0.14651349186897278],
    [0.32650336623191833, 0.49428021907806396, -0.1285477876663208],
    [0.4810796082019806, 0.49303242564201355, -0.19225530326366425],
    [0.5190742611885071, 0.5571500062942505, -0.17952655255794525],
    [0.5207500457763672, 0.6013659238815308, -0.15149006247520447]
]

puntos_correctos_l = [
    [0.37012773752212524, 0.8078495264053345, -1.2793529435839446e-07],
    [0.5296185612678528, 0.7658746838569641, -0.07570014894008636],
    [0.6744657158851624, 0.6755444407463074, -0.10782965272665024],
    [0.7944087982177734, 0.5910639762878418, -0.14038360118865967],
    [0.9017475843429565, 0.5408939719200134, -0.1745721995830536],
    [0.5664995312690735, 0.5006754994392395, -0.044546570628881454],
    [0.5969629883766174, 0.35613662004470825, -0.0979197770357132],
    [0.6027475595474243, 0.26348185539245605, -0.12925612926483154],
    [0.6105082035064697, 0.18554911017417908, -0.15059714019298553],
    [0.46279245615005493, 0.49437975883483887, -0.043930552899837494],
    [0.4701026678085327, 0.40640193223953247, -0.15419654548168182],
    [0.458394855260849, 0.5241275429725647, -0.18208618462085724],
    [0.4512113630771637, 0.6166311502456665, -0.16935555636882782],
    [0.3554001450538635, 0.5095146298408508, -0.053050123155117035],
    [0.36376672983169556, 0.4459703862667084, -0.16771019995212555],
    [0.3737536072731018, 0.5671536326408386, -0.15499280393123627],
    [0.3800186514854431, 0.6525650024414062, -0.10978588461875916],
    [0.2437863051891327, 0.5357088446617126, -0.06797212362289429],
    [0.2531265318393707, 0.45277684926986694, -0.14288830757141113],
    [0.2850802540779114, 0.5215831398963928, -0.12685084342956543],
    [0.3043820858001709, 0.5809040069580078, -0.09235094487667084]
]

puntos_correctos_m = [
    [0.5389688014984131, 0.13043473660945892, 1.6869857972778846e-06],
    [0.7209072709083557, 0.16814939677715302, -0.030788429081439972],
    [0.83033686876297, 0.2989656627178192, -0.08410748839378357],
    [0.8320528268814087, 0.4555712044239044, -0.13305416703224182],
    [0.7937453389167786, 0.5637104511260986, -0.18839971721172333],
    [0.843927264213562, 0.2868790626525879, -0.1678091287612915],
    [0.8156017661094666, 0.510551929473877, -0.22945812344551086],
    [0.793819010257721, 0.6353212594985962, -0.2710665464401245],
    [0.7724909782409668, 0.7305920124053955, -0.2999363839626312],
    [0.7081135511398315, 0.26567697525024414, -0.18803103268146515],
    [0.6849222779273987, 0.523894190788269, -0.24284140765666962],
    [0.6780092120170593, 0.6682024002075195, -0.26284167170524597],
    [0.6763915419578552, 0.7774834036827087, -0.2865012586116791],
    [0.5803433656692505, 0.270290732383728, -0.20332349836826324],
    [0.5640246868133545, 0.5195919275283813, -0.24267813563346863],
    [0.576782763004303, 0.6477344632148743, -0.24601110816001892],
    [0.5873854756355286, 0.7315558791160583, -0.25249677896499634],
    [0.4790295660495758, 0.29061222076416016, -0.2210441678762436],
    [0.47849225997924805, 0.48791056871414185, -0.2326805740594864],
    [0.5024914741516113, 0.5660297274589539, -0.21995887160301208],
    [0.5225028395652771, 0.6095278263092041, -0.21687200665473938]
]

puntos_correctos_n = [
    [0.5046938061714172, 0.13838545978069305, 1.5912339677015552e-06],
    [0.6366420984268188, 0.1946844458580017, -0.07088880985975266],
    [0.7048600912094116, 0.32889366149902344, -0.16711869835853577],
    [0.6912592053413391, 0.5336275100708008, -0.2587023675441742],
    [0.64885413646698, 0.6925320029258728, -0.35540902614593506],
    [0.6811656951904297, 0.17227424681186676, -0.21478576958179474],
    [0.704287588596344, 0.4880734086036682, -0.3148965537548065],
    [0.6987908482551575, 0.6606587767601013, -0.3864591419696808],
    [0.6899963021278381, 0.7916312217712402, -0.4341042935848236],
    [0.5541427731513977, 0.15832051634788513, -0.23461878299713135],
    [0.5835860967636108, 0.5057592391967773, -0.3189261853694916],
    [0.5999190807342529, 0.6846274137496948, -0.3482312262058258],
    [0.6054311394691467, 0.8128006458282471, -0.37686169147491455],
    [0.44516444206237793, 0.1768566370010376, -0.25328329205513],
    [0.46449726819992065, 0.48919281363487244, -0.305865615606308],
    [0.48106664419174194, 0.5710753202438354, -0.2854962944984436],
    [0.4892883896827698, 0.5944033861160278, -0.2781526744365692],
    [0.36345526576042175, 0.20888766646385193, -0.28186020255088806],
    [0.36344724893569946, 0.4460477828979492, -0.3018150329589844],
    [0.3947467505931854, 0.5357506275177002, -0.2712545394897461],
    [0.4191088378429413, 0.5704692602157593, -0.2567378878593445]
]

puntos_correctos_o = [
    [0.460470974445343, 0.6115761995315552, -1.99245718590646e-07],
    [0.5833558440208435, 0.4867135286331177, 0.03592333197593689],
    [0.6417058110237122, 0.38588565587997437, 0.030848296359181404],
    [0.6884092092514038, 0.3088833689689636, -0.0015271441079676151],
    [0.664804220199585, 0.24657423794269562, -0.03146016597747803],
    [0.47370460629463196, 0.2625438868999481, 0.08277618885040283],
    [0.5183568000793457, 0.1352236419916153, 0.021733975037932396],
    [0.6206355094909668, 0.16412925720214844, -0.03687766566872597],
    [0.6712695956230164, 0.22082725167274475, -0.06696956604719162],
    [0.42532503604888916, 0.26826947927474976, 0.028624316677451134],
    [0.4886511266231537, 0.12080996483564377, -0.034907836467027664],
    [0.612666666507721, 0.1605025827884674, -0.0861019492149353],
    [0.6681684255599976, 0.23108555376529694, -0.10970886796712875],
    [0.38196998834609985, 0.2819401025772095, -0.03382379561662674],
    [0.45129647850990295, 0.13253694772720337, -0.0917874202132225],
    [0.5802335739135742, 0.16682952642440796, -0.11619117110967636],
    [0.6445733308792114, 0.2351933866739273, -0.11857577413320541],
    [0.35052919387817383, 0.31021848320961, -0.09579218924045563],
    [0.4406788945198059, 0.19952529668807983, -0.13796931505203247],
    [0.5457811951637268, 0.20008932054042816, -0.14920547604560852],
    [0.6119542121887207, 0.23435157537460327, -0.14880700409412384]
]

puntos_correctos_p = [
    [0.47342348098754883, 0.7487553358078003, 1.282779066968942e-06],
    [0.5681316256523132, 0.6435099840164185, -0.027342312037944794],
    [0.5837941765785217, 0.5278659462928772, -0.05182546749711037],
    [0.5672035217285156, 0.44548922777175903, -0.08441314846277237],
    [0.5535934567451477, 0.36402663588523865, -0.11168757826089859],
    [0.4654180407524109, 0.40686193108558655, -0.03810969740152359],
    [0.4820363521575928, 0.27837511897087097, -0.10094210505485535],
    [0.49059146642684937, 0.19293321669101715, -0.13716574013233185],
    [0.4972786605358124, 0.11768200993537903, -0.15765447914600372],
    [0.3968905806541443, 0.4229212999343872, -0.06171552836894989],
    [0.49321478605270386, 0.34125131368637085, -0.14152514934539795],
    [0.5816192626953125, 0.29231685400009155, -0.16804932057857513],
    [0.6532905101776123, 0.2549644410610199, -0.17314034700393677],
    [0.35050493478775024, 0.46318790316581726, -0.0914747342467308],
    [0.518434464931488, 0.454698771238327, -0.18112213909626007],
    [0.5545054078102112, 0.5474675893783569, -0.1701752096414566],
    [0.5579875111579895, 0.6107650995254517, -0.13728193938732147],
    [0.3290135860443115, 0.5218083262443542, -0.12568876147270203],
    [0.4769822061061859, 0.5182105302810669, -0.1868302822113037],
    [0.5132451057434082, 0.5828809142112732, -0.17325226962566376],
    [0.5139328241348267, 0.6274293661117554, -0.14585237205028534]
]

puntos_correctos_q = [
    [0.5026617646217346, 0.33091506361961365, 3.7785201811857405e-07],
    [0.4124312400817871, 0.446174681186676, -0.08649253100156784],
    [0.38637080788612366, 0.5824575424194336, -0.153802752494812],
    [0.403953492641449, 0.7164506912231445, -0.1969379484653473],
    [0.4433418810367584, 0.8196579217910767, -0.2303074300289154],
    [0.576459527015686, 0.5108731985092163, -0.22733575105667114],
    [0.6216585636138916, 0.6926901340484619, -0.2898526191711426],
    [0.5988316535949707, 0.7675217390060425, -0.3008708357810974],
    [0.5707064867019653, 0.8091251850128174, -0.30044519901275635],
    [0.6945474743843079, 0.5042875409126282, -0.19718946516513824],
    [0.6694470643997192, 0.7193495035171509, -0.24691207706928253],
    [0.5964586138725281, 0.7279815673828125, -0.2279880791902542],
    [0.5595113039016724, 0.6883132457733154, -0.21265776455402374],
    [0.7740465998649597, 0.5100650787353516, -0.16281279921531677],
    [0.724550187587738, 0.7010201215744019, -0.18793326616287231],
    [0.6544447541236877, 0.692338228225708, -0.15066568553447723],
    [0.624155580997467, 0.6459718346595764, -0.12743563950061798],
    [0.8187143802642822, 0.5166276693344116, -0.13503120839595795],
    [0.7698853611946106, 0.6702871918678284, -0.14585915207862854],
    [0.7143974304199219, 0.6643365025520325, -0.12420583516359329],
    [0.6911934614181519, 0.6234875321388245, -0.10821031033992767]
]


puntos_correctos_r = [
    [0.49321281909942627, 0.8237852454185486, 1.5652094589313492e-06],
    [0.6114783883094788, 0.7318069338798523, -0.05249379947781563],
    [0.6401674747467041, 0.6214687824249268, -0.07574506103992462],
    [0.5804356932640076, 0.5351806282997131, -0.10428343713283539],
    [0.5232755541801453, 0.4613770544528961, -0.12909799814224243],
    [0.5924996137619019, 0.4710174798965454, -0.02518531307578087],
    [0.5791071653366089, 0.32935968041419983, -0.07657594978809357],
    [0.5737071633338928, 0.24485808610916138, -0.10992416739463806],
    [0.5668796300888062, 0.16737288236618042, -0.12919488549232483],
    [0.5071391463279724, 0.46940967440605164, -0.03697911277413368],
    [0.5390402674674988, 0.30034971237182617, -0.09620624035596848],
    [0.5748483538627625, 0.2034415900707245, -0.12716415524482727],
    [0.6041048765182495, 0.1224416196346283, -0.13842901587486267],
    [0.4197925627231598, 0.5033368468284607, -0.058191388845443726],
    [0.4106200337409973, 0.3960271179676056, -0.153975248336792],
    [0.4541248679161072, 0.488699734210968, -0.160481259226799],
    [0.4896244406700134, 0.57117760181427, -0.13358666002750397],
    [0.341758131980896, 0.5653406381607056, -0.08299229294061661],
    [0.35539039969444275, 0.4907906949520111, -0.16084825992584229],
    [0.41328269243240356, 0.5493014454841614, -0.15418408811092377],
    [0.45178207755088806, 0.6119587421417236, -0.12768371403217316]
]

puntos_correctos_s = [
    [0.4775509238243103, 0.5856624245643616, -7.962013341966667e-07],
    [0.5985469222068787, 0.4893544614315033, -0.02554449252784252],
    [0.6773345470428467, 0.3862607777118683, -0.04641708731651306],
    [0.6560946702957153, 0.2957371175289154, -0.07553743571043015],
    [0.5647082328796387, 0.26934877038002014, -0.09974852204322815],
    [0.6018460988998413, 0.2703670561313629, 0.0072920010425150394],
    [0.6294775605201721, 0.18766963481903076, -0.05063391476869583],
    [0.6429489850997925, 0.24762515723705292, -0.08194100856781006],
    [0.6333423852920532, 0.28812068700790405, -0.09617269784212112],
    [0.5142216682434082, 0.27616238594055176, -0.011814047582447529],
    [0.5430142879486084, 0.1954742968082428, -0.07286593317985535],
    [0.5620628595352173, 0.29487061500549316, -0.08988551050424576],
    [0.5454697608947754, 0.32474908232688904, -0.08864229172468185],
    [0.42668306827545166, 0.2974959909915924, -0.039848003536462784],
    [0.4570261836051941, 0.2274157851934433, -0.1154739037156105],
    [0.48594555258750916, 0.3323523700237274, -0.10063695162534714],
    [0.4679262042045593, 0.37021228671073914, -0.07260501384735107],
    [0.3271980881690979, 0.3326570987701416, -0.06893428415060043],
    [0.3762710690498352, 0.28005820512771606, -0.11554504185914993],
    [0.4151012599468231, 0.3540348708629608, -0.09018450975418091],
    [0.4050361216068268, 0.39053165912628174, -0.06051991134881973]
]

puntos_correctos_t = [
    [0.47160711884498596, 0.7453329563140869, -7.851081136323046e-07],
    [0.5887063145637512, 0.6336497068405151, -0.05388583987951279],
    [0.625878095626831, 0.4529918432235718, -0.06589415669441223],
    [0.5539093017578125, 0.30751538276672363, -0.07730123400688171],
    [0.4943656325340271, 0.20446930825710297, -0.07762078195810318],
    [0.5797418355941772, 0.3346136808395386, -0.0036004793364554644],
    [0.5622715950012207, 0.16917453706264496, -0.08682048320770264],
    [0.5785694122314453, 0.21324625611305237, -0.1239948645234108],
    [0.5867289304733276, 0.3053106367588043, -0.12909509241580963],
    [0.47236886620521545, 0.36260661482810974, -0.005879884120076895],
    [0.44818636775016785, 0.208103746175766, -0.09742286801338196],
    [0.49348360300064087, 0.34383881092071533, -0.11378398537635803],
    [0.5182238817214966, 0.4281805753707886, -0.09352347254753113],
    [0.3772439956665039, 0.41236943006515503, -0.02323971688747406],
    [0.37965983152389526, 0.33146095275878906, -0.13010962307453156],
    [0.4279882609844208, 0.4765979051589966, -0.1131507083773613],
    [0.43753108382225037, 0.5321992039680481, -0.0665387213230133],
    [0.2830597162246704, 0.4770303964614868, -0.04323394224047661],
    [0.2991388738155365, 0.40373021364212036, -0.11042284220457077],
    [0.3458074629306793, 0.5033435821533203, -0.08567359298467636],
    [0.35072061419487, 0.5419090986251831, -0.04661396145820618]
]

puntos_correctos_u = [
    [0.5273512005805969, 0.8596372604370117, 1.7186072227559634e-06],
    [0.6403988003730774, 0.7790087461471558, -0.08040694892406464],
    [0.6796067357063293, 0.6710970997810364, -0.12391264736652374],
    [0.6081438660621643, 0.598105788230896, -0.16774792969226837],
    [0.5198236703872681, 0.5460190176963806, -0.2090618908405304],
    [0.6186441779136658, 0.4787582457065582, -0.07329061627388],
    [0.6294481158256531, 0.32764673233032227, -0.1431669443845749],
    [0.6335266828536987, 0.2358558475971222, -0.18820883333683014],
    [0.6283407807350159, 0.15271246433258057, -0.21503229439258575],
    [0.5176206231117249, 0.4821222126483917, -0.08258209377527237],
    [0.5405818819999695, 0.3007100522518158, -0.1578705906867981],
    [0.5556470155715942, 0.1913534700870514, -0.19841797649860382],
    [0.5615392327308655, 0.09896937012672424, -0.21652792394161224],
    [0.4213617444038391, 0.5292242169380188, -0.1017572432756424],
    [0.3942676782608032, 0.40866905450820923, -0.2157350480556488],
    [0.4440375864505768, 0.5060117244720459, -0.22887110710144043],
    [0.48330584168434143, 0.5885096788406372, -0.2045694887638092],
    [0.3374054729938507, 0.6081403493881226, -0.12606261670589447],
    [0.3424627184867859, 0.5379526019096375, -0.22326289117336273],
    [0.4044971764087677, 0.6021243333816528, -0.2237257957458496],
    [0.4475235939025879, 0.6644188165664673, -0.19975177943706512]
]

puntos_correctos_v = [
    [0.4761267304420471, 0.8106963634490967, 1.3312593409864348e-06],
    [0.5699315071105957, 0.7329991459846497, -0.05738351494073868],
    [0.5926631093025208, 0.6456177234649658, -0.08635762333869934],
    [0.534789502620697, 0.5776085257530212, -0.11762944608926773],
    [0.47778022289276123, 0.5226657390594482, -0.14491389691829681],
    [0.5597768425941467, 0.4834878146648407, -0.03786623477935791],
    [0.6135376691818237, 0.3609595000743866, -0.08896305412054062],
    [0.6448851823806763, 0.28431713581085205, -0.12548285722732544],
    [0.6660557985305786, 0.2178652584552765, -0.14776217937469482],
    [0.46647995710372925, 0.4808841645717621, -0.04597095027565956],
    [0.4316057860851288, 0.33309632539749146, -0.10398250818252563],
    [0.410512775182724, 0.2398100197315216, -0.1405179351568222],
    [0.39372915029525757, 0.1626092493534088, -0.15849630534648895],
    [0.38817963004112244, 0.5205682516098022, -0.06127940118312836],
    [0.3571661710739136, 0.43560758233070374, -0.1471233367919922],
    [0.40533629059791565, 0.5026882290840149, -0.16115868091583252],
    [0.4411410987377167, 0.5651153326034546, -0.14470542967319489],
    [0.32497772574424744, 0.5873029828071594, -0.08025622367858887],
    [0.32384103536605835, 0.5285711884498596, -0.15005375444889069],
    [0.3754124045372009, 0.5676746964454651, -0.14864955842494965],
    [0.4166852831840515, 0.6111046671867371, -0.12873953580856323]
]

puntos_correctos_w = [
    [0.4853413701057434, 0.7902617454528809, 1.3658317357112537e-06],
    [0.5844835638999939, 0.7135252952575684, -0.06890877336263657],
    [0.6060099601745605, 0.6030703783035278, -0.09072647988796234],
    [0.5041145086288452, 0.5207874178886414, -0.10317155718803406],
    [0.4046038091182709, 0.4794014096260071, -0.11510862410068512],
    [0.5796079635620117, 0.4515935778617859, -0.04828270897269249],
    [0.6225270628929138, 0.3114735782146454, -0.07814761251211166],
    [0.6500846147537231, 0.23105356097221375, -0.10572812706232071],
    [0.6674474477767944, 0.1603345274925232, -0.12634731829166412],
    [0.4753616452217102, 0.43960824608802795, -0.04628627374768257],
    [0.47965097427368164, 0.28706908226013184, -0.06741677969694138],
    [0.48535603284835815, 0.19501689076423645, -0.09508100897073746],
    [0.491028755903244, 0.12268808484077454, -0.1142653226852417],
    [0.38608288764953613, 0.4677879214286804, -0.052418019622564316],
    [0.3254033923149109, 0.33118003606796265, -0.09776680171489716],
    [0.3066819906234741, 0.23796696960926056, -0.14502443373203278],
    [0.29303595423698425, 0.16401201486587524, -0.1754940152168274],
    [0.3103005290031433, 0.528853178024292, -0.062289971858263016],
    [0.27780234813690186, 0.42659008502960205, -0.11280443519353867],
    [0.32154378294944763, 0.4317976236343384, -0.12479166686534882],
    [0.36626142263412476, 0.4608771502971649, -0.12765130400657654]
]

puntos_correctos_x = [
    [0.27427414059638977, 0.6071646213531494, -1.9574792986531975e-06],
    [0.2826947569847107, 0.466738224029541, -0.1290728896856308],
    [0.36610737442970276, 0.30300676822662354, -0.23128294944763184],
    [0.449496865272522, 0.23042050004005432, -0.32638493180274963],
    [0.4642089307308197, 0.3077535629272461, -0.3992656171321869],
    [0.6860896348953247, 0.419412225484848, -0.19320014119148254],
    [0.8436005711555481, 0.4462285041809082, -0.340208500623703],
    [0.7463269829750061, 0.45663154125213623, -0.39213332533836365],
    [0.6131864190101624, 0.46344006061553955, -0.40245887637138367],
    [0.7397534847259521, 0.555415153503418, -0.17663393914699554],
    [0.576267421245575, 0.5999237895011902, -0.3191291391849518],
    [0.408753365278244, 0.57502281665802, -0.31506961584091187],
    [0.380933940410614, 0.5475866198539734, -0.2845568060874939],
    [0.7263103723526001, 0.6803463697433472, -0.1795101761817932],
    [0.5091844201087952, 0.7169545888900757, -0.2940778434276581],
    [0.3920902609825134, 0.6696354746818542, -0.2487334907054901],
    [0.39093083143234253, 0.6342047452926636, -0.1968955546617508],
    [0.6867236495018005, 0.7938567996025085, -0.19868725538253784],
    [0.5080535411834717, 0.8182747960090637, -0.2769468128681183],
    [0.402095764875412, 0.7686047554016113, -0.2628061771392822],
    [0.3915861248970032, 0.7287960648536682, -0.2300855964422226]
]

puntos_correctos_y = [
    [0.25141578912734985, 0.5748766660690308, -5.066681296739262e-07],
    [0.3310561180114746, 0.4371945261955261, -0.027049101889133453],
    [0.44791632890701294, 0.32117047905921936, -0.07282394915819168],
    [0.5419231057167053, 0.2305743396282196, -0.11294643580913544],
    [0.5867614150047302, 0.1442832052707672, -0.14080838859081268],
    [0.5399495959281921, 0.40751025080680847, -0.13630372285842896],
    [0.7569867372512817, 0.4450075030326843, -0.18903470039367676],
    [0.6874864101409912, 0.46519988775253296, -0.19222599267959595],
    [0.6089499592781067, 0.45348072052001953, -0.18895021080970764],
    [0.5414999127388, 0.5137907862663269, -0.14754869043827057],
    [0.7471480369567871, 0.546074628829956, -0.18779589235782623],
    [0.6765373945236206, 0.553102433681488, -0.16900762915611267],
    [0.6072938442230225, 0.541373074054718, -0.15928611159324646],
    [0.5274352431297302, 0.6110076904296875, -0.1565331369638443],
    [0.7340666651725769, 0.6334059834480286, -0.18722695112228394],
    [0.6706727147102356, 0.6374800205230713, -0.1442975401878357],
    [0.5939900279045105, 0.6293598413467407, -0.1178571879863739],
    [0.5022022128105164, 0.6930232048034668, -0.16650833189487457],
    [0.6664661169052124, 0.7473968267440796, -0.20248934626579285],
    [0.7608949542045593, 0.7804598808288574, -0.1995375156402588],
    [0.8518714904785156, 0.7986793518066406, -0.19678236544132233]
]

puntos_correctos_z = [
    [0.3435925841331482, 0.8075246214866638, -1.287327677346184e-06],
    [0.27687105536460876, 0.709129810333252, -0.07793894410133362],
    [0.26948800683021545, 0.6130806803703308, -0.13788624107837677],
    [0.36185353994369507, 0.5733184218406677, -0.19827182590961456],
    [0.4579501748085022, 0.5373001098632812, -0.2540793716907501],
    [0.4014204144477844, 0.40147387981414795, -0.09344102442264557],
    [0.4520230293273926, 0.26683762669563293, -0.17283819615840912],
    [0.4848403334617615, 0.18938980996608734, -0.22743278741836548],
    [0.5144717693328857, 0.1194828450679779, -0.26464879512786865],
    [0.5254732966423035, 0.43846845626831055, -0.09959983825683594],
    [0.5664985775947571, 0.4964071214199066, -0.223728209733963],
    [0.4880566895008087, 0.6119064092636108, -0.26447194814682007],
    [0.40754687786102295, 0.6805115938186646, -0.26593640446662903],
    [0.6180391311645508, 0.5046884417533875, -0.1128009781241417],
    [0.6364552974700928, 0.5782824754714966, -0.22927933931350708],
    [0.5296684503555298, 0.6734431385993958, -0.21677199006080627],
    [0.43960559368133545, 0.7228400707244873, -0.17883186042308807],
    [0.6826217174530029, 0.5804064273834229, -0.13337205350399017],
    [0.7192732095718384, 0.6294270753860474, -0.2062952071428299],
    [0.6258511543273926, 0.69269859790802, -0.18449653685092926],
    [0.5385321378707886, 0.7241420745849609, -0.14732180535793304]
]



def comparar_puntos(mano_actual, puntos_correctos, tolerancia=0.3):
    for i, punto_correcto in enumerate(puntos_correctos):
        if not np.allclose([mano_actual[i].x, mano_actual[i].y, mano_actual[i].z], punto_correcto, atol=tolerancia):
            return False
    return True

def comparar_conjuntos_puntos(mano_actual, conjuntos_puntos_correctos, tolerancia=0.3):
    for index, conjunto in enumerate(conjuntos_puntos_correctos):
        if comparar_puntos(mano_actual, conjunto, tolerancia):
            print(f"Conjunto detectado: {index}")
            return index  # Devuelve el índice del conjunto detectado
    return -1 

conjuntos_puntos_correctos = [puntos_correctos_a, puntos_correctos_b, puntos_correctos_c, 
                              puntos_correctos_d, puntos_correctos_e, puntos_correctos_f,
                              puntos_correctos_g, puntos_correctos_h, puntos_correctos_i,
                                puntos_correctos_j, puntos_correctos_k, puntos_correctos_l,
                                puntos_correctos_m, puntos_correctos_n, puntos_correctos_o,
                                puntos_correctos_p, puntos_correctos_q, puntos_correctos_r,
                                puntos_correctos_s, puntos_correctos_t, puntos_correctos_u,
                                puntos_correctos_v, puntos_correctos_w, puntos_correctos_x,
                                puntos_correctos_y, puntos_correctos_z]

@sock.route('/video-stream')
def video_stream(ws):
    while True:
        data = ws.receive()
        if data:
            # Decodificar frame
            np_frame = np.frombuffer(data, np.uint8)
            frame = cv2.imdecode(np_frame, cv2.IMREAD_COLOR)

            rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            resultado = hands.process(rgb_frame)

            if resultado.multi_hand_landmarks:
                for hand_landmarks in resultado.multi_hand_landmarks:
                    # Dibujamos las conexiones de la mano
                    mp_drawing.draw_landmarks(frame, hand_landmarks, mp_hands.HAND_CONNECTIONS)

                    # Extraemos los puntos actuales de la mano
                    puntos_mano = hand_landmarks.landmark

                    conjunto_detectado = comparar_conjuntos_puntos(puntos_mano, conjuntos_puntos_correctos)
                    print(f"Conjunto detectado: {conjunto_detectado}")
                    if conjunto_detectado != -1:
                        if conjunto_detectado == 0:
                            ws.send("a")
                        elif conjunto_detectado == 1:
                            ws.send("b")
                        elif conjunto_detectado == 2:
                            ws.send("c")
                        elif conjunto_detectado == 3:
                            ws.send("d")
                        elif conjunto_detectado == 4:
                            ws.send("e")
                        elif conjunto_detectado == 5:
                            ws.send("f")
                        elif conjunto_detectado == 6:
                            ws.send("g")
                        elif conjunto_detectado == 7:
                            ws.send("h")
                        elif conjunto_detectado == 8:
                            ws.send("i")
                        elif conjunto_detectado == 9:
                            ws.send("j")
                        elif conjunto_detectado == 10:
                            ws.send("k")
                        elif conjunto_detectado == 11:
                            ws.send("l")
                        elif conjunto_detectado == 12:
                            ws.send("m")
                        elif conjunto_detectado == 13:
                            ws.send("n")
                        elif conjunto_detectado == 14:
                            ws.send("o")
                        elif conjunto_detectado == 15:
                            ws.send("p")
                        elif conjunto_detectado == 16:
                            ws.send("q")
                        elif conjunto_detectado == 17:
                            ws.send("r")
                        elif conjunto_detectado == 18:
                            ws.send("s")
                        elif conjunto_detectado == 19:
                            ws.send("t")
                        elif conjunto_detectado == 20:
                            ws.send("u")
                        elif conjunto_detectado == 21:
                            ws.send("v")
                        elif conjunto_detectado == 22:
                            ws.send("w")
                        elif conjunto_detectado == 23:
                            ws.send("x")
                        elif conjunto_detectado == 24:
                            ws.send("y")
                        elif conjunto_detectado == 25:
                            ws.send("z")
                    else:
                        ws.send("Sin letra detectada")
        else:
            break


@sock.route('/abc')
def abc(ws):
    while True:
        data = ws.receive()
        if data:
            # Decodificar frame
            np_frame = np.frombuffer(data, np.uint8)
            frame = cv2.imdecode(np_frame, cv2.IMREAD_COLOR)

            rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            resultado = hands.process(rgb_frame)

            if resultado.multi_hand_landmarks:
                for hand_landmarks in resultado.multi_hand_landmarks:
                    # Dibujamos las conexiones de la mano
                    mp_drawing.draw_landmarks(frame, hand_landmarks, mp_hands.HAND_CONNECTIONS)

                    # Extraemos los puntos actuales de la mano
                    puntos_mano = hand_landmarks.landmark

                    conjunto_detectado = comparar_conjuntos_puntos(puntos_mano, conjuntos_puntos_correctos)
                    print(f"Conjunto detectado: {conjunto_detectado}")
                    if conjunto_detectado != -1:
                        if conjunto_detectado == 0:
                            ws.send("a")
                        elif conjunto_detectado == 1:
                            ws.send("b")
                        elif conjunto_detectado == 2:
                            ws.send("c")
                    else:
                        ws.send("Sin letra detectada")
        else:
            break

@app.route('/hola')
def hola():
    return "Hola mundo"

if __name__ == "__main__":
    app.run(host='0.0.0.0', port=5000, debug=True)
